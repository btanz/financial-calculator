//
   Created by benjamintanz on 09.06.15.

   Layout conventions:
      Format for ids of input-fields should always be like this: module-subfunction-type-value
      Example: boerse-options-text-strike or boerse-options-select-optiontype

extends layout

block content

  //- sidebar on the right
  include ./includes/sidebar.jade

  div.row.wrapper.border-bottom.white-bg.page-heading
    div.col-lg-12
      h2= obj.name
      h3= obj.description
    //
      ol.breadcrumb
        li
          a(href='/') Home
          a(href='/') Home again

  div.wrapper.wrapper-content
    div.row
      div.col-lg-12

        div.ibox.float-e-margins
          div.ibox-title
            h5
              i.fa.fa-edit.fa-lg.text-navy &nbsp
              | Eingaben

          div.ibox-content
            form
              each input in obj.inputs
                - var rank = input.secondary ? 'm-l-lg' : ''
                - var hide = input.hide ? 'hide' : ''
                //- template for text input fields
                if input.type === 'text'
                  if input.linetop
                    div.hr-line-dashed
                  div.form-group(class=rank, class=hide)
                    label(for=input.id)
                      i(class='fa fa-question-circle fa-lg', data-toggle='tooltip', data-placement='top', title=input.tooltip) &nbsp
                      | #{input.label}
                    if input.addon
                      div.input-group
                        input(placeholder=input.placeholder, id=input.id, type=input.type, value=input.value, class="form-control")
                        span.input-group-addon= input.addon
                    else
                      input(placeholder=input.placeholder, id=input.id, type=input.type, value=input.value, class="form-control")

                //- template for number input fields
                if input.type === 'number'
                  if input.linetop
                    div.hr-line-dashed
                  div.form-group(class=rank, class=hide)
                    label(for=input.id)
                      i(class='fa fa-question-circle fa-lg', data-toggle='tooltip', data-placement='top', title=input.tooltip) &nbsp
                      | #{input.label}
                    if input.addon
                      div.input-group
                        input(placeholder=input.placeholder, id=input.id, type=input.type, value=input.value, class="form-control")
                        span.input-group-addon= input.addon
                    else
                      input(placeholder=input.placeholder, id=input.id, type=input.type, value=input.value, class="form-control")

                //- template for select input fields
                if input.type === 'select'
                  if input.linetop
                    div.hr-line-dashed
                  div.form-group(class=rank, class=hide)
                    label(for=input.id)
                      i(class='fa fa-question-circle fa-lg', data-toggle='tooltip', data-placement='top', title=input.tooltip) &nbsp
                      | #{input.label}
                    select(id=input.id, class="form-control")
                      each option, index in input.options
                        - var optgroup = (option === '_OPTGROUP')
                          if optgroup
                            optgroup(label=index)
                          else
                            option(value=index)= option

                //- template for date input fields
                if input.type === 'date'
                  if input.linetop
                    div.hr-line-dashed
                  div.form-group(class=rank, class=hide)
                    label(for=input.id)
                      i(class='fa fa-question-circle fa-lg', data-toggle='tooltip', data-placement='top', title=input.tooltip) &nbsp
                      | #{input.label}
                    div.input-group.date
                      span.input-group-addon
                        i.fa.fa-calendar
                      input(type='text', id=input.id, value=input.value, class='form-control')

              button.btn.btn-primary.btn-block.m-t#btn-calculate Berechnen

    div.row
      div.col-lg-12#results-1

    div.row
      div.col-lg-12#results-2

    div.row
      div.col-lg-12#results-3

    div.row
      div.col-lg-12#results-4

    div.row
      div.col-lg-12#results-5

    div.row
      div.col-lg-12#results-6



  //- handlebars templates to be used on the client for output

  //- main results template
  script(id='main-results-template', type='text/x-handlebars-template')
    div.ibox.float-e-margins
      div.ibox-title
        h5
          i.fa.fa-check-square-o.fa-lg.text-navy &nbsp
          |Ergebnisse

      div.ibox-content
        table.table.table-striped
          tbody
            | {{#each obj}}
            tr
              td
                i(class='fa fa-question-circle fa-lg', data-toggle='tooltip', data-placement='top', title='{{this.tooltip}}') &nbsp
                | {{this.description}}
              td(style='text-align: right') {{numFormat this.value this.digits}}  {{this.unit}}
            | {{/each}}

  //- main results error template
  script(id='main-results-error-template', type='text/x-handlebars-template')
    div.ibox.float-e-margins
      div.ibox-title
        h5
          i.fa.fa-check-square-o.fa-lg.text-navy &nbsp
          | Ergebnisse

      div.ibox-content
        h4.text-danger
          i.fa.fa-frown-o.fa-lg &nbsp
          | Berechnungsfehler
        p Das Ergebnis konnte leider nicht berechnet werden. Fehlt eine Angabe oder sind Angaben nicht korrrekt?
        | {{#if obj.errors}}
        p Folgende Meldungen helfen bei der Fehlersuche:
        | {{#each obj.errors}}
        //- XXX when in Production, switch true to this.errorPrint
        | {{#if true}}
        p.text-danger  - {{this.errorMessage}}
        | {{/if}}
        | {{/each}}
        | {{/if}}

  //- main results input template
  script(id='main-results-input-template', type='text/x-handlebars-template')
    div.ibox.float-e-margins
      div.ibox-title
        h5
          i.fa.fa-check-square-o.fa-lg.text-navy &nbsp
          | Ergebnisse

      div.ibox-content
          p Fülle alle Eingabefelder aus und drücke den 'Berechnen'-Button, um die Ergebnisse darzustellen.


  //- todo: Rework to switch / find more elegant solution
  //- include calculator specific templates
  - var boerse_fx = (obj.id === 'boerse-fx')
  if boerse_fx
    include ./includes/calculator/boerse-fx

  - var boerse_equityreturn = (obj.id === 'boerse-equityreturn')
  if boerse_equityreturn
    include ./includes/calculator/boerse-equityreturn

